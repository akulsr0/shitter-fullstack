<html>
  <head>
    <title>Post</title>
    <style>
      @import url('https://fonts.googleapis.com/css?family=Lato:300,400,700,900&display=swap');
      @import url('https://fonts.googleapis.com/css?family=Acme&display=swap');

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      a {
        text-decoration: none;
        color: unset;
      }
      .dashboardHeader {
        width: 100%;
        height: 40px;
        background-color: #3c6382;
        display: flex;
        flex-direction: row;
      }

      .headerLeft {
        height: 40px;
        display: flex;
        flex: 1;
        flex-direction: row;
        align-items: center;
      }

      .headerRight {
        display: flex;
        flex-direction: row;
        align-items: center;
        padding-right: 20px;
      }

      .headerUsername {
        font-weight: 700;
        font-family: 'Lato';
        color: #f5f5fa;
        margin-left: 14px;
        cursor: pointer;
      }

      .logoutButton {
        width: 80px;
        height: 30px;
        background-color: #0a3d62;
        border: none;
        color: #f5f5fa;
        border-radius: 6px;
        font-family: 'Lato';
        font-weight: 500;
        font-size: 16px;
        cursor: pointer;
      }

      .navDiv {
        display: flex;
        flex-direction: row;
        justify-content: center;
        margin-top: 16px;
      }

      .navDiv a {
        text-decoration: none;
        margin-left: 10px;
        margin-right: 10px;
        font-family: 'Lato';
        font-weight: 500;
        color: #0a3d62;
      }

      textarea {
        width: 60%;
        height: 100px;
        font-family: 'Lato';
        font-weight: 300;
        color: #333;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #0a3d62;
        border-radius: 6px 6px 0px 0px;
        outline: none;
      }

      .postButton {
        width: 60%;
        height: 30px;
        background-color: #0a3d62;
        border: none;
        color: #f5f5fa;
        border-radius: 0px 0px 6px 6px;
        font-family: 'Lato';
        font-weight: 500;
        font-size: 16px;
        cursor: pointer;
      }

      .createPost {
        margin-top: 20px;
        display: flex;
        flex-direction: row;
        justify-content: center;
      }

      .postsDiv {
        width: 100%;
        height: 300px;
        margin-top: 10px;
        display: flex;
        flex-direction: column;
      }

      .post {
        background-color: #fff;
        margin-left: 20px;
        margin-top: 10px;
        margin-right: 40px;
        font-family: 'Lato';
        padding-bottom: 0px;
        border-radius: 6px;
      }

      .defaultDP {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid #333;
        margin-right: 8px;
      }

      .postAuthorInfoDiv {
        background-color: #dcdde1;
        padding-top: 4px;
        padding-bottom: 4px;
        padding-left: 8px;
        padding-right: 8px;
        border-radius: 6px 6px 0px 0px;
        display: flex;
        flex-direction: row;
      }

      .postTextDiv {
        padding-top: 10px;
        padding-bottom: 10px;
        padding-left: 8px;
        padding-right: 8px;
        font-family: 'Acme', cursive;
        font-weight: 300;
        font-size: 20px;
        color: #353b48;
      }

      .postInteractDiv {
        background-color: #f5f5fa;
        padding-left: 8px;
        padding-right: 8px;
        padding-top: 4px;
        padding-bottom: 4px;
        display: flex;
        flex-direction: row;
      }

      .postInteractDiv div:not(:first-child) {
        margin-left: 10px;
      }

      .postInteractDiv button {
        padding: 4px;
        padding-left: 10px;
        padding-right: 10px;
        background-color: #0a3d62;
        border: none;
        color: #f5f5fa;
        font-family: 'Lato';
        font-weight: 700;
        border-radius: 4px;
        cursor: pointer;
      }

      .postLikes {
        max-height: 200px;

        overflow-y: scroll;
        padding-left: 10px;
        padding-top: 4px;
      }

      .postLikes ul {
        margin-top: 6px;
      }

      .postLikes ul li {
        margin-bottom: 4px;
      }

      .postLikes strong {
        font-size: 20px;
        font-weight: 900;
      }

      .shitarea {
        padding-left: 10px;
        padding-right: 10px;
        padding-top: 4px;
        padding-bottom: 10px;
      }

      .shitarea strong {
        font-size: 20px;
        font-weight: 900;
      }

      .shitarea textarea {
        width: 100%;
        height: 100px;
        font-family: 'Lato';
        font-weight: 300;
        color: #333;
        padding: 6px;
        font-size: 16px;
        border: 1px solid #0a3d62;
        border-radius: 6px 6px 0px 0px;
        outline: none;
      }

      .addShitButton {
        width: 100%;
        height: 30px;
        background-color: #0a3d62;
        border: none;
        color: #f5f5fa;
        border-radius: 0px 0px 6px 6px;
        font-family: 'Lato';
        font-weight: 700;
        font-size: 16px;
        cursor: pointer;
      }

      .postDeleteButton {
        background-color: red;
        color: #f5f5fa;
        padding-left: 10px;
        padding-right: 10px;
        height: 30px;
        font-weight: 500;
        font-size: 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
    </style>
  </head>
  <body bgcolor="#60a3bc">
    <header class="dashboardHeader">
      <div class="headerLeft">
        <h3 class="headerUsername" onclick="gotoHome()"><%= user.name %></h3>
      </div>
      <div class="headerRight">
        <form method="POST" action="/logout">
          <button class="logoutButton">Logout</button>
        </form>
      </div>
    </header>
    <div class="post">
      <div class="postAuthorInfoDiv">
        <% if(post.authorGender=='Male') { %>
        <img
          src="https://banner2.cleanpng.com/20180615/rtc/kisspng-avatar-user-profile-male-logo-profile-icon-5b238cb002ed52.870627731529056432012.jpg"
          class="defaultDP"
        />
        <% } else { %>
        <img
          src="https://cdn2.iconfinder.com/data/icons/ios-7-icons/50/user_female-512.png"
          class="defaultDP"
        />
        <% } %>
        <div style="display: flex; flex: 1; flex-direction: column">
          <strong><%= post.authorName %></strong>
          <small><%= post.authorEmail %></small>
        </div>
        <% if(post.authorEmail==user.email) { %>
        <div style="display: flex; align-items: center; padding-right: 10px">
          <form action="/posts/delete/<%=post._id%>" method="post">
            <button class="postDeleteButton">Delete</button>
          </form>
        </div>
        <% } %>
        <div style="display: flex; align-items: center; padding-right: 10px ">
          <% const dateArr = post.timestamp.toString().split(' ') %> <% const
          dateStr = dateArr.slice(1,4).join(' ') %>
          <strong><%= dateStr %></strong>
        </div>
      </div>
      <div class="postTextDiv"><%= post.postText %></div>
      <div class="postLikes">
        <% const likes = post.likes %>
        <strong>Liked By</strong>
        <hr
          size="0.05"
          color="#333"
          style="margin-top: 4px; margin-right: 10px"
        />
        <ul>
          <% likes.map(liker => { %>
          <li><%= liker.name %> (<%= liker.email %>)</li>
          <% }) %>
        </ul>
      </div>
      <div class="shitarea">
        <strong>Shits on this</strong>
        <hr
          size="0.05"
          color="#333"
          style="margin-top: 4px; margin-bottom: 10px"
        />
        <% const shits = post.shits %> <% const latestShitsArray =
        shits.reverse() %> <% latestShitsArray.map(shit => { %>
        <div class="shit">
          <div style="flex: 1;">
            <strong><%=shit.author.name%></strong> <br />
            <%=shit.shit%>
          </div>
          <div style="display: flex; align-items: center; padding-right: 10px">
            <% if(user.id==shit.author._id) { %>
            <form
              action="/posts/<%=post._id%>/deleteshit/<%=shit._id%>"
              method="post"
            >
              <button class="shitDeleteButton">Delete</button>
            </form>
            <% } %>
          </div>
        </div>
        <% }) %>
        <form action="/add/<%=post._id%>" method="post" style="width: 100%;">
          <textarea name="shit" placeholder="Add some shit"></textarea>
          <button class="addShitButton">SUBMIT</button>
        </form>
      </div>
    </div>
  </body>
  <script>
    function gotoHome() {
      window.location = '/';
    }
  </script>
</html>
